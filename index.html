<textarea id="stdout" readonly></textarea>
<br>
<form method="post" action="api">
    <div class="send">
        <input class="text" autocomplete="off" type="text" name="ipt">
        <br>
        <br>
        <input class="send" type="submit" value="Enviar">
    </div>
</form>

<script src="socket.io.js"></script>
<script>    
    let form = document.querySelector("form");
    let stdout = document.querySelector("#stdout");

    let setupText = (t) => {
        stdout.value = t;
        stdout.scrollTop = stdout.scrollHeight;
    }


    form.addEventListener("submit", (event) => {
        event.preventDefault(); 

        fetch("api", {
            method: "post",
            body: new FormData(form)
        })
    });

    fetch("getStdout", {
        method: "get"
    })
    .then(r => r.text())
    .then(r => {
        setupText(r);
    })

    var socket = io();

    socket.on("stdout", (msg) => {
        setupText(msg);
    });
</script>


<style>
    * {
        margin: 0;
        padding: 0;
        background: black;
        color: white;
    }
    input, textarea {
        border: none;
        outline: 1px solid white;
    }
    input { 
        padding: 5px;
    }
    .text {
        width: 100%;
    }
    textarea {
        width: 100%;
        height: 500px;
        resize: vertical
    }
</style>